<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Công cụ tạo đơn khởi kiện hàng loạt</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Times New Roman", serif;
        }
        
        body {
            background: #f0f0f0;
            padding: 20px;
            line-height: 1.4;
        }
        
        .container {
            max-width: 210mm;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        /* Header giống mẫu Word */
        .document-header {
            padding: 30px 40px 20px 40px;
            text-align: center;
        }
        
        .document-date {
            text-align: center;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .document-title {
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            margin: 20px 0;
            text-transform: uppercase;
        }
        
        .document-subtitle {
            text-align: center;
            font-style: italic;
            margin-bottom: 30px;
        }
        
        /* Nội dung đơn */
        .document-content {
            padding: 0 40px 40px 40px;
        }
        
        .section {
            margin-bottom: 25px;
        }
        
        .section-title {
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
        }
        
        .indent {
            padding-left: 40px;
        }
        
        .underline {
            text-decoration: underline;
            font-weight: bold;
        }
        
        /* Bảng số liệu */
        .debt-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 14px;
        }
        
        .debt-table td {
            border: 1px solid #000;
            padding: 8px 12px;
            vertical-align: top;
        }
        
        .debt-table tr:last-child {
            font-weight: bold;
            background: #f0f0f0;
        }
        
        /* Form nhập liệu */
        .input-form {
            background: #f9f9f9;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #ddd;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-family: "Times New Roman", serif;
            font-size: 14px;
        }
        
        .form-group textarea {
            height: 80px;
            resize: vertical;
        }
        
        /* Nút điều khiển */
        .controls {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            margin: 0 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-family: "Times New Roman", serif;
            font-size: 14px;
        }
        
        .btn-primary {
            background: #2c3e50;
            color: white;
        }
        
        .btn-success {
            background: #27ae60;
            color: white;
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        /* Phần xem trước */
        .preview-section {
            display: none;
            margin-top: 30px;
        }
        
        .document-preview {
            background: white;
            padding: 40px;
            border: 1px solid #ccc;
            min-height: 297mm;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .signature-section {
            text-align: right;
            margin-top: 100px;
            font-style: italic;
        }
        
        /* Tab cho nhiều khách hàng */
        .customer-tabs {
            margin: 20px 0;
        }
        
        .tab-buttons {
            display: flex;
            margin-bottom: 10px;
        }
        
        .tab-btn {
            padding: 10px 20px;
            background: #ddd;
            border: none;
            cursor: pointer;
            margin-right: 5px;
        }
        
        .tab-btn.active {
            background: #2c3e50;
            color: white;
        }
        
        .customer-form {
            display: none;
            background: #f9f9f9;
            padding: 20px;
            border: 1px solid #ccc;
        }
        
        .customer-form.active {
            display: block;
        }
        
        .customer-actions {
            text-align: center;
            margin: 20px 0;
        }
        
        /* In ấn */
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .input-form, .controls, .customer-tabs {
                display: none !important;
            }
            
            .preview-section {
                display: block !important;
            }
            
            .document-preview {
                box-shadow: none;
                border: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Form nhập liệu -->
        <div class="input-form">
            <h2 style="text-align: center; margin-bottom: 20px;">NHẬP THÔNG TIN ĐƠN KHỞI KIỆN</h2>
            
            <!-- Tab cho nhiều khách hàng -->
            <div class="customer-tabs">
                <div class="tab-buttons" id="tabButtons">
                    <!-- Tab buttons sẽ được thêm bằng JavaScript -->
                </div>
                <div id="customerForms">
                    <!-- Customer forms sẽ được thêm bằng JavaScript -->
                </div>
                <div class="customer-actions">
                    <button class="btn btn-primary" onclick="addCustomer()">+ Thêm khách hàng</button>
                    <button class="btn btn-danger" onclick="removeCustomer()">- Xóa khách hàng</button>
                </div>
            </div>
            
            <!-- Thông tin chung -->
            <div class="section">
                <div class="section-title">THÔNG TIN CHUNG</div>
                <div class="form-group">
                    <label>Tên Tòa án:</label>
                    <input type="text" id="courtName" value="TÒA ÁN NHÂN DÂN KHU VỰC 8, THÀNH PHỐ HỒ CHÍ MINH">
                </div>
                <div class="form-group">
                    <label>Ngày lập đơn:</label>
                    <input type="text" id="currentDate" value="Thành phố Hồ Chí Minh, ngày 22 tháng 11 năm 2025">
                </div>
            </div>
            
            <!-- Thông tin Ngân hàng -->
            <div class="section">
                <div class="section-title">THÔNG TIN BÊN KHỞI KIỆN</div>
                <div class="form-group">
                    <label>Tên ngân hàng:</label>
                    <input type="text" id="plaintiffName" value="Ngân hàng TMCP Việt Nam Thịnh Vượng (VPBank)">
                </div>
                <div class="form-group">
                    <label>Địa chỉ trụ sở:</label>
                    <input type="text" id="plaintiffAddress" value="Số 89 Láng Hạ, phường Đống Đa, Tp. Hà Nội">
                </div>
                <div class="form-group">
                    <label>Địa chỉ liên lạc:</label>
                    <input type="text" id="plaintiffContact" value="Tầng 1, số 96 Cao Thắng, phường Bàn Cờ, Tp. Hồ Chí Minh">
                </div>
                <div class="form-group">
                    <label>Người đại diện theo pháp luật:</label>
                    <input type="text" id="legalRepresentative" value="Ông Ngô Chí Dũng - Chủ tịch Hội đồng quản trị">
                </div>
                <div class="form-group">
                    <label>Người đại diện theo ủy quyền:</label>
                    <input type="text" id="authorizedRepresentative" value="Ông Đỗ Thành Trung - Chức vụ: Phó Giám đốc Trung tâm THN KHDN & XLN pháp lý">
                </div>
                <div class="form-group">
                    <label>Văn bản ủy quyền:</label>
                    <input type="text" id="authorizationDoc" value="Văn bản ủy quyền số 50/2025/UQN-CTQT ngày 07/11/2025 của Chủ tịch Hội đồng quản trị Ngân hàng TMCP Việt Nam Thịnh Vượng - VPBank">
                </div>
            </div>
            
            <!-- Hợp đồng vay -->
            <div class="section">
                <div class="section-title">THÔNG TIN HỢP ĐỒNG VAY</div>
                <div id="contractsContainer">
                    <!-- Hợp đồng sẽ được thêm bằng JavaScript -->
                </div>
                <div style="text-align: center; margin: 15px 0;">
                    <button class="btn btn-primary" onclick="addContract()">+ Thêm hợp đồng</button>
                    <button class="btn btn-danger" onclick="removeContract()">- Xóa hợp đồng</button>
                </div>
            </div>
            
            <!-- Thông tin vi phạm -->
            <div class="section">
                <div class="section-title">THÔNG TIN VI PHẠM</div>
                <div class="form-group">
                    <label>Ngày bắt đầu vi phạm:</label>
                    <input type="text" id="violationDate" value="10/05/2023">
                </div>
                <div class="form-group">
                    <label>Mô tả vi phạm:</label>
                    <textarea id="violationDescription">Trong quá trình sử dụng vốn vay của những Hợp đồng cho vay trên, khách hàng đã quá hạn thanh toán nợ gốc và lãi vay cho VPBank. Mặc dù, Ngân hàng đã tạo điều kiện về thời gian cho khách hàng trả nợ nhưng phía khách hàng vẫn không có phương án trả dứt nợ cho ngân hàng.

Xét thấy bên vay không còn khả năng thanh toán nợ, do đó VPBank đã chuyển toàn bộ khoản vay sang nợ quá hạn và thông báo chấm dứt việc thực hiện đối với hợp đồng cho vay trên, đồng thời tiến hành khởi kiện đương sự tại Toà án nhân dân có thẩm quyền để giải quyết.</textarea>
                </div>
            </div>
            
            <!-- Yêu cầu khởi kiện -->
            <div class="section">
                <div class="section-title">YÊU CẦU KHỞI KIỆN</div>
                <div class="form-group">
                    <label>Tổng nợ gốc:</label>
                    <input type="text" id="totalPrincipal" value="37.584.578 đồng">
                </div>
                <div class="form-group">
                    <label>Tổng nợ lãi:</label>
                    <input type="text" id="totalInterest" value="58.635.006 đồng">
                </div>
                <div class="form-group">
                    <label>Tổng cộng:</label>
                    <input type="text" id="grandTotal" value="96.219.584 đồng">
                </div>
            </div>
            
            <div class="controls">
                <button class="btn btn-success" onclick="generateDocument()">TẠO ĐƠN KHỞI KIỆN</button>
                <button class="btn btn-primary" onclick="printDocument()">IN ĐƠN</button>
                <button class="btn btn-primary" onclick="downloadDocument()">TẢI VỀ WORD</button>
            </div>
        </div>
        
        <!-- Xem trước -->
        <div class="preview-section" id="previewSection">
            <div class="document-preview" id="documentPreview">
                <!-- Nội dung đơn sẽ được hiển thị ở đây -->
            </div>
        </div>
    </div>

    <script>
        let customerCount = 1;
        let contractCount = 2;
        let currentCustomer = 1;
        
        // Khởi tạo form
        document.addEventListener('DOMContentLoaded', function() {
            initializeCustomerTabs();
            initializeContracts();
        });
        
        // Quản lý khách hàng
        function initializeCustomerTabs() {
            addCustomer(); // Thêm khách hàng đầu tiên
        }
        
        function addCustomer() {
            customerCount++;
            const customerId = customerCount;
            
            // Thêm tab button
            const tabButtons = document.getElementById('tabButtons');
            const tabBtn = document.createElement('button');
            tabBtn.className = 'tab-btn';
            tabBtn.textContent = `KH ${customerId}`;
            tabBtn.onclick = () => switchCustomer(customerId);
            tabButtons.appendChild(tabBtn);
            
            // Thêm form khách hàng
            const customerForms = document.getElementById('customerForms');
            const customerForm = document.createElement('div');
            customerForm.className = 'customer-form';
            customerForm.id = `customerForm${customerId}`;
            customerForm.innerHTML = `
                <div class="section">
                    <div class="section-title">THÔNG TIN BÊN BỊ KIỆN - KHÁCH HÀNG ${customerId}</div>
                    <div class="form-group">
                        <label>Họ tên:</label>
                        <input type="text" id="defendantName${customerId}" value="${customerId === 1 ? 'Phan Nhật Linh' : ''}">
                    </div>
                    <div class="form-group">
                        <label>Năm sinh:</label>
                        <input type="text" id="defendantYear${customerId}" value="${customerId === 1 ? '1996' : ''}">
                    </div>
                    <div class="form-group">
                        <label>CMND/CCCD:</label>
                        <input type="text" id="defendantID${customerId}" value="${customerId === 1 ? '079096006806' : ''}">
                    </div>
                    <div class="form-group">
                        <label>Ngày cấp:</label>
                        <input type="text" id="idIssueDate${customerId}" value="${customerId === 1 ? '22/11/2021' : ''}">
                    </div>
                    <div class="form-group">
                        <label>Nơi cấp:</label>
                        <input type="text" id="idIssuePlace${customerId}" value="${customerId === 1 ? 'Cục Cảnh sát về QLHC và TTXH' : ''}">
                    </div>
                    <div class="form-group">
                        <label>Địa chỉ:</label>
                        <input type="text" id="defendantAddress${customerId}" value="${customerId === 1 ? '158/5A ấp Thới Tây 2, Xã Hóc Môn (Xã Tân Hiệp, Huyện Hóc Môn cũ), Thành phố Hồ Chí Minh' : ''}">
                    </div>
                    <div class="form-group">
                        <label>Số điện thoại:</label>
                        <input type="text" id="defendantPhone${customerId}" value="${customerId === 1 ? '0901350113' : ''}">
                    </div>
                </div>
            `;
            customerForms.appendChild(customerForm);
            
            // Kích hoạt tab mới
            switchCustomer(customerId);
        }
        
        function removeCustomer() {
            if (customerCount > 1) {
                // Xóa tab button
                const tabButtons = document.getElementById('tabButtons');
                tabButtons.removeChild(tabButtons.lastChild);
                
                // Xóa form khách hàng
                const customerForms = document.getElementById('customerForms');
                customerForms.removeChild(document.getElementById(`customerForm${customerCount}`));
                
                customerCount--;
                switchCustomer(customerCount);
            }
        }
        
        function switchCustomer(customerId) {
            currentCustomer = customerId;
            
            // Cập nhật active tab
            document.querySelectorAll('.tab-btn').forEach((btn, index) => {
                btn.classList.toggle('active', index === customerId - 1);
            });
            
            // Hiển thị form tương ứng
            document.querySelectorAll('.customer-form').forEach(form => {
                form.classList.remove('active');
            });
            document.getElementById(`customerForm${customerId}`).classList.add('active');
        }
        
        // Quản lý hợp đồng
        function initializeContracts() {
            // Hợp đồng 1
            addContract(true);
            document.getElementById('contract1Type').value = 'Giấy đăng ký kiêm hợp đồng cho vay không TSBĐ, mở & sử dụng tài khoản thanh toán và dịch vụ ngân hàng điện tử';
            document.getElementById('contract1Date').value = '08/12/2023';
            document.getElementById('contract1Amount').value = '30.000.000 đồng';
            document.getElementById('contract1Purpose').value = 'vay tiêu dùng';
            document.getElementById('contract1Term').value = '48 tháng';
            document.getElementById('contract1Interest').value = '23%/năm được cố định đến kỳ điều chỉnh lãi suất gần nhất, sau đó định kỳ điều chỉnh 03 tháng/01 lần (+) biên độ 18%/năm';
            document.getElementById('debtDate1').value = '20/11/2025';
            document.getElementById('principal1').value = '27.042.271 đồng';
            document.getElementById('interest1').value = '32.070.580 đồng';
            document.getElementById('total1').value = '59.112.851 đồng';
            
            // Hợp đồng 2
            addContract(true);
            document.getElementById('contract2Type').value = 'Giấy đề nghị kiêm hợp đồng cấp hạn mức tín dụng thẻ, phát hành và sử dụng thẻ tín dụng dịch vụ ngân hàng điện tử';
            document.getElementById('contract2Date').value = '05/12/2023';
            document.getElementById('contract2Amount').value = '11.000.000 đồng';
            document.getElementById('contract2Purpose').value = 'Vay tiêu dùng';
            document.getElementById('contract2Interest').value = '47.88%/năm';
            document.getElementById('debtDate2').value = '20/11/2025';
            document.getElementById('principal2').value = '10.542.307 đồng';
            document.getElementById('interest2').value = '26.564.426 đồng';
            document.getElementById('total2').value = '37.106.733 đồng';
        }
        
        function addContract(isInitial = false) {
            if (!isInitial) {
                contractCount++;
            }
            const contractId = isInitial ? contractCount : contractCount;
            
            const contractDiv = document.createElement('div');
            contractDiv.className = 'contract-section';
            contractDiv.style.background = '#f5f5f5';
            contractDiv.style.padding = '15px';
            contractDiv.style.margin = '10px 0';
            contractDiv.style.border = '1px solid #ddd';
            contractDiv.id = `contract${contractId}`;
            
            contractDiv.innerHTML = `
                <h4 style="margin-bottom: 15px;">HỢP ĐỒNG VAY ${contractId}</h4>
                <div class="form-group">
                    <label>Loại hợp đồng:</label>
                    <input type="text" id="contract${contractId}Type">
                </div>
                <div class="form-group">
                    <label>Ngày ký:</label>
                    <input type="text" id="contract${contractId}Date">
                </div>
                <div class="form-group">
                    <label>Số tiền vay/Hạn mức:</label>
                    <input type="text" id="contract${contractId}Amount">
                </div>
                <div class="form-group">
                    <label>Mục đích vay:</label>
                    <input type="text" id="contract${contractId}Purpose">
                </div>
                <div class="form-group">
                    <label>Thời hạn vay:</label>
                    <input type="text" id="contract${contractId}Term">
                </div>
                <div class="form-group">
                    <label>Lãi suất:</label>
                    <input type="text" id="contract${contractId}Interest">
                </div>
                <div class="form-group">
                    <label>Dư nợ đến ngày:</label>
                    <input type="text" id="debtDate${contractId}">
                </div>
                <table class="debt-table">
                    <tr>
                        <td>Nợ gốc:</td>
                        <td><input type="text" id="principal${contractId}" style="width: 100%; border: none; background: transparent;"></td>
                    </tr>
                    <tr>
                        <td>Nợ lãi:</td>
                        <td><input type="text" id="interest${contractId}" style="width: 100%; border: none; background: transparent;"></td>
                    </tr>
                    <tr>
                        <td>Tổng cộng:</td>
                        <td><input type="text" id="total${contractId}" style="width: 100%; border: none; background: transparent;"></td>
                    </tr>
                </table>
            `;
            
            document.getElementById('contractsContainer').appendChild(contractDiv);
        }
        
        function removeContract() {
            if (contractCount > 1) {
                const contractDiv = document.getElementById(`contract${contractCount}`);
                contractDiv.remove();
                contractCount--;
            }
        }
        
        // Tạo đơn
        function generateDocument() {
            const customerId = currentCustomer;
            
            // Lấy thông tin từ form
            const courtName = document.getElementById('courtName').value;
            const currentDate = document.getElementById('currentDate').value;
            const plaintiffName = document.getElementById('plaintiffName').value;
            const plaintiffAddress = document.getElementById('plaintiffAddress').value;
            const plaintiffContact = document.getElementById('plaintiffContact').value;
            const legalRepresentative = document.getElementById('legalRepresentative').value;
            const authorizedRepresentative = document.getElementById('authorizedRepresentative').value;
            const authorizationDoc = document.getElementById('authorizationDoc').value;
            
            const defendantName = document.getElementById(`defendantName${customerId}`).value;
            const defendantYear = document.getElementById(`defendantYear${customerId}`).value;
            const defendantID = document.getElementById(`defendantID${customerId}`).value;
            const idIssueDate = document.getElementById(`idIssueDate${customerId}`).value;
            const idIssuePlace = document.getElementById(`idIssuePlace${customerId}`).value;
            const defendantAddress = document.getElementById(`defendantAddress${customerId}`).value;
            const defendantPhone = document.getElementById(`defendantPhone${customerId}`).value;
            
            const violationDate = document.getElementById('violationDate').value;
            const violationDescription = document.getElementById('violationDescription').value;
            
            const totalPrincipal = document.getElementById('totalPrincipal').value;
            const totalInterest = document.getElementById('totalInterest').value;
            const grandTotal = document.getElementById('grandTotal').value;
            
            // Tạo nội dung hợp đồng
            let contractsContent = '';
            for (let i = 1; i <= contractCount; i++) {
                const contractType = document.getElementById(`contract${i}Type`).value;
                const contractDate = document.getElementById(`contract${i}Date`).value;
                const contractAmount = document.getElementById(`contract${i}Amount`).value;
                const contractPurpose = document.getElementById(`contract${i}Purpose`).value;
                const contractTerm = document.getElementById(`contract${i}Term`).value;
                const contractInterest = document.getElementById(`contract${i}Interest`).value;
                const debtDate = document.getElementById(`debtDate${i}`).value;
                const principal = document.getElementById(`principal${i}`).value;
                const interest = document.getElementById(`interest${i}`).value;
                const total = document.getElementById(`total${i}`).value;
                
                contractsContent += `
${i}.  <strong>${contractType}</strong> ngày ${contractDate}, cụ thể:<br><br>

- ${contractAmount.includes('Hạn mức') ? 'Hạn mức tín dụng:' : 'Số tiền cho vay:'} ${contractAmount}<br>
- Mục đích vay: ${contractPurpose}<br>
${contractTerm ? `- Thời hạn vay: ${contractTerm}<br>` : ''}
- Lãi suất: ${contractInterest}<br><br>

Dư nợ thực tế tạm tính đến ngày ${debtDate} theo hợp đồng cho vay trên là:<br><br>

<table class="debt-table">
    <tr>
        <td style="width: 30%;">- Nợ gốc:</td>
        <td style="width: 70%;">${principal}</td>
    </tr>
    <tr>
        <td>- Nợ lãi:</td>
        <td>${interest}</td>
    </tr>
    <tr>
        <td><strong>Tổng cộng:</strong></td>
        <td><strong>${total}</strong></td>
    </tr>
</table>
<br>
`;
            }
            
            // Tạo nội dung đơn
            const documentContent = `
<div class="document-date">${currentDate}</div>

<div class="document-title">ĐƠN SỬA ĐỔI BỔ SUNG ĐƠN KHỞI KIỆN</div>

<div class="document-subtitle">(V/v ông/bà ${defendantName} vi phạm hợp đồng tín dụng)</div>

<div><strong>Kính gửi: ${courtName}</strong></div>

<br>

<div class="section-title">I. BÊN KHỞI KIỆN: <strong>${plaintiffName}</strong>.</div>

<div class="indent">
    - Địa chỉ trụ sở: ${plaintiffAddress}.<br>
    - Địa chỉ liên lạc: ${plaintiffContact}.<br>
    - Người đại diện theo pháp luật: <strong>${legalRepresentative}</strong>.<br>
    - Người đại diện theo ủy quyền: <strong>${authorizedRepresentative}</strong>.<br>
    <br>
    <em>(${authorizationDoc}).</em>
</div>

<br>

<div class="section-title">II. BÊN BỊ KIỆN: ÔNG/BÀ ${defendantName} SINH NĂM: ${defendantYear}</div>

<div class="indent">
    - CMND/CCCD số ${defendantID} do ${idIssuePlace} cấp ngày ${idIssueDate}.<br>
    - Địa chỉ: ${defendantAddress}.<br>
    - Số điện thoại: ${defendantPhone}
</div>

<br>

<div class="section-title">III. NỘI DUNG KHỞI KIỆN:</div>

<div class="indent">
    ${plaintiffName.split(' ')[0]} <em>(sau đây gọi tắt là "VPBank")</em> với ông/bà ${defendantName} đã cùng ký kết các Hợp đồng cho vay như sau:<br><br>
    
    ${contractsContent}
    
    Từ ngày ${violationDate} ông/bà ${defendantName} đã vi phạm nghĩa vụ thanh toán nợ vay cho VPBank.<br><br>
    
    ${violationDescription.replace(/\n/g, '<br>')}
</div>

<br>

<div class="section-title underline">[YÊU CẦU CỦA NGƯỜI KHỞI KIỆN]</div>

<br>

<div class="indent">
    Kính đề nghị Quý Tòa thụ lý giải quyết vụ án và xem xét phán quyết:<br><br>
    
    1. Buộc ông/bà ${defendantName} phải thanh toán cho VPBank một lần tổng dư nợ tạm tính đến ngày ${document.getElementById('debtDate1').value} là:<br><br>
    
    <table class="debt-table">
        <tr>
            <td style="width: 30%;">- Nợ gốc:</td>
            <td style="width: 70%;">${totalPrincipal}</td>
        </tr>
        <tr>
            <td>- Nợ lãi:</td>
            <td>${totalInterest}</td>
        </tr>
        <tr>
            <td><strong>Tổng cộng:</strong></td>
            <td><strong>${grandTotal}</strong></td>
        </tr>
    </table>
    <br>
    
    2. Yêu cầu Tòa án tuyên trong bản án tiếp tục cho tính lãi theo đúng thỏa thuận trong các Hợp đồng cho đến khi ông/bà ${defendantName} thực tế thanh toán hết nợ cho VPBank.<br><br>
    
    3. Ông/bà ${defendantName} phải chịu toàn bộ án phí và các chi phí liên quan (nếu có) do vi phạm nghĩa vụ thanh toán.<br><br>
    
    Những nội dung đã trình bày như trên là đúng sự thật, kính trình Quý Tòa thẩm xét./
</div>

<br><br>

<div class="signature-section">
    <div><strong>NGƯỜI KHỞI KIỆN</strong></div>
    <br><br><br>
    <div><strong>${plaintiffName.split('(')[0].trim()}</strong></div>
    <br>
    <div><strong>NGƯỜI ĐẠI DIỆN THEO ỦY QUYỀN</strong></div>
    <br><br>
    <div><strong>${authorizedRepresentative.split('-')[0].trim()}</strong></div>
</div>
            `;
            
            // Hiển thị preview
            document.getElementById('documentPreview').innerHTML = documentContent;
            document.getElementById('previewSection').style.display = 'block';
            
            // Cuộn đến phần preview
            document.getElementById('previewSection').scrollIntoView({ behavior: 'smooth' });
        }
        
        function printDocument() {
            window.print();
        }
        
        function downloadDocument() {
            const content = document.getElementById('documentPreview').innerHTML;
            const customerName = document.getElementById(`defendantName${currentCustomer}`).value;
            const blob = new Blob([`
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body { 
                            font-family: "Times New Roman", serif; 
                            line-height: 1.4;
                            padding: 40px;
                        }
                        .debt-table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 15px 0;
                        }
                        .debt-table td {
                            border: 1px solid #000;
                            padding: 8px 12px;
                        }
                        .debt-table tr:last-child {
                            font-weight: bold;
                            background: #f0f0f0;
                        }
                        .document-title {
                            text-align: center;
                            font-weight: bold;
                            font-size: 16px;
                            margin: 20px 0;
                            text-transform: uppercase;
                        }
                        .document-date {
                            text-align: center;
                            margin-bottom: 30px;
                            font-style: italic;
                        }
                        .section-title {
                            font-weight: bold;
                            margin: 15px 0 10px 0;
                            text-transform: uppercase;
                        }
                        .indent {
                            padding-left: 40px;
                        }
                        .underline {
                            text-decoration: underline;
                            font-weight: bold;
                        }
                        .signature-section {
                            text-align: right;
                            margin-top: 100px;
                            font-style: italic;
                        }
                    </style>
                </head>
                <body>
                    ${content}
                </body>
                </html>
            `], { type: 'text/html' });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Don_khoi_kien_${customerName.replace(/\s+/g, '_')}.doc`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
